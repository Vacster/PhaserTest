<!doctype html>
<html>
    <head>
        <meta charset="UTF-8" />
        <title>Phaser Test!</title>
        <script src="/phaser.js"></script>
    </head>

    <body style="background-color:black">
      <div id="gamediv" style="width:85%; height:100%; margin:auto"></div>
    </body>

    <script type="text/javascript">

    window.onload = function() {
        const horizontal_step = 0.5;
        const max_acc = 15;

        var game = new Phaser.Game(1280, 720, Phaser.AUTO, 'gamediv', { preload: preload, create: create, update: update, render: render });
        var mouse, plane;
        var acc = 0;

        function preload () {
          game.load.spritesheet('plane', 'airplane.png', 200, 200, 25);
          game.input.mouse.capture = true;
        }

        function create () {
          game.scale.scaleMode = Phaser.ScaleManager.SHOW_ALL;
          game.scale.pageAlignHorizontally = true;
          game.scale.pageAlignVertically = true;

          plane = game.add.sprite(game.world.centerX, game.world.height * 0.8, 'plane');
          plane.anchor.x = 0.5;
          plane.anchor.y = 0.5;

        }

        function update () {
          mouse = game.input.activePointer;

          if(mouse.isDown)
          {
            acc -= acc > - max_acc ? horizontal_step : 0;
          }
          else
          {
            acc += acc < max_acc ? horizontal_step : 0;
          }

          determineFrame();
          plane.x += acc;
        }

        function render()
        {
          game.debug.spriteInfo(plane, plane.x + 100, plane.y - 100);
          game.debug.text("Acceleration: " + acc, 32, 32);
          game.debug.text("Frame: " + plane.frame, 32, 64);
        }

        function determineFrame()
        {
          if(acc > 13)
            plane.frame = 4;
          else if(acc > 4)
            plane.frame = 3;
          else if(acc < -13)
            plane.frame = 0;
          else if(acc < -4)
            plane.frame = 1;
          else
            plane.frame = 2;
        }
    };

    </script>
</html>
